[2023-12-09T19:18:39.713+0530] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Cricbuzz_ETL.load manual__2023-12-09T13:48:32.015139+00:00 [queued]>
[2023-12-09T19:18:39.720+0530] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Cricbuzz_ETL.load manual__2023-12-09T13:48:32.015139+00:00 [queued]>
[2023-12-09T19:18:39.720+0530] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2023-12-09T19:18:39.733+0530] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): load> on 2023-12-09 13:48:32.015139+00:00
[2023-12-09T19:18:39.738+0530] {standard_task_runner.py:57} INFO - Started process 47169 to run task
[2023-12-09T19:18:39.741+0530] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'Cricbuzz_ETL', 'load', 'manual__2023-12-09T13:48:32.015139+00:00', '--job-id', '210', '--raw', '--subdir', 'DAGS_FOLDER/Crickbuzz_dag.py', '--cfg-path', '/tmp/tmpe3kt85g4']
[2023-12-09T19:18:39.742+0530] {standard_task_runner.py:85} INFO - Job 210: Subtask load
[2023-12-09T19:18:39.769+0530] {task_command.py:416} INFO - Running <TaskInstance: Cricbuzz_ETL.load manual__2023-12-09T13:48:32.015139+00:00 [running]> on host Iris
[2023-12-09T19:18:39.826+0530] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='Cricbuzz_ETL' AIRFLOW_CTX_TASK_ID='load' AIRFLOW_CTX_EXECUTION_DATE='2023-12-09T13:48:32.015139+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-12-09T13:48:32.015139+00:00'
[2023-12-09T19:18:39.886+0530] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "ball_by_ball_data_pkey"
DETAIL:  Key (match_id)=(10082023) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/rajabala/Desktop/projects/Airflow/dags/Cricbuzz_files/Load.py", line 34, in load_to_db
    ball_by_ball_data.to_sql(name='ball_by_ball_data', con=conn, index=False, if_exists='append')
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/rajabala/Desktop/projects/Airflow/airflow_env/lib/python3.9/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ball_by_ball_data_pkey"
DETAIL:  Key (match_id)=(10082023) already exists.

[SQL: INSERT INTO ball_by_ball_data (match_id, ball, "Commentary Text", innings, batting_team, bowling_team, "Batsman", "Bowler", runs, extra, ball_length, ball_line, ball_speed, shot_name, ball_destination, out_type) VALUES (%(match_id)s, %(ball)s, %(Commentary_Text)s, %(innings)s, %(batting_team)s, %(bowling_team)s, %(Batsman)s, %(Bowler)s, %(runs)s, %(extra)s, %(ball_length)s, %(ball_line)s, %(ball_speed)s, %(shot_name)s, %(ball_destination)s, %(out_type)s)]
[parameters: ({'match_id': '10082023', 'ball': 49.3, 'Commentary_Text': ' Siraj to Starc, out Caught by Shreyas Iyer!! Another good catch and Australia have been bowled out for 199. The slower ball is dug into the pitch, S ... (114 characters truncated) ... deep square leg and judges it well to take it after that sprint. India need exactly 200 to win this. Starc c Shreyas Iyer b Siraj 28(35) [4s-2 6s-1] ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': 'out', 'extra': 'out', 'ball_length': 'Good', 'ball_line': None, 'ball_speed': None, 'shot_name': 'pull shot', 'ball_destination': 'deep square', 'out_type': 'Catch out , shreyas iyer'}, {'match_id': '10082023', 'ball': 49.2, 'Commentary_Text': ' Siraj to Starc, FOUR, Australia just one short of 200 now. Siraj misses the yorker on the stumps, the half-volley is smashed straight down the ground. Well wide of mid-off who was inside the ring ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': '4', 'extra': '0', 'ball_length': 'Short', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': 'beaten', 'ball_destination': 'straight', 'out_type': None}, {'match_id': '10082023', 'ball': 49.1, 'Commentary_Text': " Siraj to Starc, no run, full on the stumps, drilled straight to the fielder at long-on and Starc won't take the single on offer ", 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': '0', 'extra': '0', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': None, 'ball_destination': 'straight', 'out_type': None}, {'match_id': '10082023', 'ball': 48.6, 'Commentary_Text': ' Hardik Pandya to Starc, 1 run, Starc keeps the strike. Just pushes the slower ball off-cutter in front of extra-cover and takes an easy single ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '1', 'extra': '0', 'ball_length': None, 'ball_line': None, 'ball_speed': None, 'shot_name': 'square cut', 'ball_destination': 'cover', 'out_type': None}, {'match_id': '10082023', 'ball': 48.5, 'Commentary_Text': ' Hardik Pandya to Starc, FOUR, handy runs these. The line is on leg-stump on this slower ball off-cutter, flicked wide of short fine-leg and it runs away to the deep backward square leg fence. Rohit with a slight frown on his face ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '4', 'extra': '0', 'ball_length': 'Short', 'ball_line': 'leg side', 'ball_speed': None, 'shot_name': 'cut shot', 'ball_destination': 'short fine', 'out_type': None}, {'match_id': '10082023', 'ball': 48.4, 'Commentary_Text': ' Hardik Pandya to Starc, no run, slower ball off-cutter outside off, keeps low, Starc cuts and the bottom-edge rolls to Rahul ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '0', 'extra': '0', 'ball_length': None, 'ball_line': 'off side', 'ball_speed': None, 'shot_name': 'edge', 'ball_destination': None, 'out_type': None}, {'match_id': '10082023', 'ball': 48.3, 'Commentary_Text': ' Hardik Pandya to Hazlewood, 1 run, slower ball full on the stumps, Hazlewood drives to sweeper cover and turns the strike over ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Hazlewood', 'Bowler': ' Hardik Pandya', 'runs': '1', 'extra': '0', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': 'drive', 'ball_destination': 'sweeper', 'out_type': None}, {'match_id': '10082023', 'ball': 48.2, 'Commentary_Text': ' Hardik Pandya to Zampa, out Caught by Kohli!! Straight to mid-off. Full and seam-up on the stumps, Zampa makes room to loft and finds the man. Right ... (33 characters truncated) ...  elevation or power. Hardik Pandya still looking at the end of his fingers on which he took a blow at the start. Zampa c Kohli b Hardik Pandya 6(20) ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Zampa', 'Bowler': ' Hardik Pandya', 'runs': 'out', 'extra': 'out', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': None, 'ball_destination': 'Straight', 'out_type': 'Catch out , kohli'}  ... displaying 10 of 557 total bound parameter sets ...  {'match_id': '10082023', 'ball': 0.1, 'Commentary_Text': ' Starc to Rohit, no run, 136.1 clicks, big inswinger that thuds onto the pads. A half appeal from Starc but ending well down leg ', 'innings': '2nd Inns', 'batting_team': 'IND', 'bowling_team': 'AUS', 'Batsman': 'Rohit', 'Bowler': ' Starc', 'runs': '0', 'extra': '0', 'ball_length': None, 'ball_line': None, 'ball_speed': None, 'shot_name': None, 'ball_destination': None, 'out_type': None}, {'match_id': '10082023', 'ball': 0.1, 'Commentary_Text': " Starc to Rohit, wide, finds some swing but that movement takes the ball down the leg side. Sharma shimmies in and tries to flick but can't connect ", 'innings': '2nd Inns', 'batting_team': 'IND', 'bowling_team': 'AUS', 'Batsman': 'Rohit', 'Bowler': ' Starc', 'runs': 'wide', 'extra': '1', 'ball_length': None, 'ball_line': 'wide', 'ball_speed': None, 'shot_name': 'wide', 'ball_destination': None, 'out_type': None})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2023-12-09T19:18:39.894+0530] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=Cricbuzz_ETL, task_id=load, execution_date=20231209T134832, start_date=20231209T134839, end_date=20231209T134839
[2023-12-09T19:18:39.905+0530] {standard_task_runner.py:104} ERROR - Failed to execute job 210 for task load ((psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ball_by_ball_data_pkey"
DETAIL:  Key (match_id)=(10082023) already exists.

[SQL: INSERT INTO ball_by_ball_data (match_id, ball, "Commentary Text", innings, batting_team, bowling_team, "Batsman", "Bowler", runs, extra, ball_length, ball_line, ball_speed, shot_name, ball_destination, out_type) VALUES (%(match_id)s, %(ball)s, %(Commentary_Text)s, %(innings)s, %(batting_team)s, %(bowling_team)s, %(Batsman)s, %(Bowler)s, %(runs)s, %(extra)s, %(ball_length)s, %(ball_line)s, %(ball_speed)s, %(shot_name)s, %(ball_destination)s, %(out_type)s)]
[parameters: ({'match_id': '10082023', 'ball': 49.3, 'Commentary_Text': ' Siraj to Starc, out Caught by Shreyas Iyer!! Another good catch and Australia have been bowled out for 199. The slower ball is dug into the pitch, S ... (114 characters truncated) ... deep square leg and judges it well to take it after that sprint. India need exactly 200 to win this. Starc c Shreyas Iyer b Siraj 28(35) [4s-2 6s-1] ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': 'out', 'extra': 'out', 'ball_length': 'Good', 'ball_line': None, 'ball_speed': None, 'shot_name': 'pull shot', 'ball_destination': 'deep square', 'out_type': 'Catch out , shreyas iyer'}, {'match_id': '10082023', 'ball': 49.2, 'Commentary_Text': ' Siraj to Starc, FOUR, Australia just one short of 200 now. Siraj misses the yorker on the stumps, the half-volley is smashed straight down the ground. Well wide of mid-off who was inside the ring ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': '4', 'extra': '0', 'ball_length': 'Short', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': 'beaten', 'ball_destination': 'straight', 'out_type': None}, {'match_id': '10082023', 'ball': 49.1, 'Commentary_Text': " Siraj to Starc, no run, full on the stumps, drilled straight to the fielder at long-on and Starc won't take the single on offer ", 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Siraj', 'runs': '0', 'extra': '0', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': None, 'ball_destination': 'straight', 'out_type': None}, {'match_id': '10082023', 'ball': 48.6, 'Commentary_Text': ' Hardik Pandya to Starc, 1 run, Starc keeps the strike. Just pushes the slower ball off-cutter in front of extra-cover and takes an easy single ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '1', 'extra': '0', 'ball_length': None, 'ball_line': None, 'ball_speed': None, 'shot_name': 'square cut', 'ball_destination': 'cover', 'out_type': None}, {'match_id': '10082023', 'ball': 48.5, 'Commentary_Text': ' Hardik Pandya to Starc, FOUR, handy runs these. The line is on leg-stump on this slower ball off-cutter, flicked wide of short fine-leg and it runs away to the deep backward square leg fence. Rohit with a slight frown on his face ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '4', 'extra': '0', 'ball_length': 'Short', 'ball_line': 'leg side', 'ball_speed': None, 'shot_name': 'cut shot', 'ball_destination': 'short fine', 'out_type': None}, {'match_id': '10082023', 'ball': 48.4, 'Commentary_Text': ' Hardik Pandya to Starc, no run, slower ball off-cutter outside off, keeps low, Starc cuts and the bottom-edge rolls to Rahul ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Starc', 'Bowler': ' Hardik Pandya', 'runs': '0', 'extra': '0', 'ball_length': None, 'ball_line': 'off side', 'ball_speed': None, 'shot_name': 'edge', 'ball_destination': None, 'out_type': None}, {'match_id': '10082023', 'ball': 48.3, 'Commentary_Text': ' Hardik Pandya to Hazlewood, 1 run, slower ball full on the stumps, Hazlewood drives to sweeper cover and turns the strike over ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Hazlewood', 'Bowler': ' Hardik Pandya', 'runs': '1', 'extra': '0', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': 'drive', 'ball_destination': 'sweeper', 'out_type': None}, {'match_id': '10082023', 'ball': 48.2, 'Commentary_Text': ' Hardik Pandya to Zampa, out Caught by Kohli!! Straight to mid-off. Full and seam-up on the stumps, Zampa makes room to loft and finds the man. Right ... (33 characters truncated) ...  elevation or power. Hardik Pandya still looking at the end of his fingers on which he took a blow at the start. Zampa c Kohli b Hardik Pandya 6(20) ', 'innings': '1st Inns', 'batting_team': 'AUS', 'bowling_team': 'IND', 'Batsman': 'Zampa', 'Bowler': ' Hardik Pandya', 'runs': 'out', 'extra': 'out', 'ball_length': 'Full', 'ball_line': 'stump line', 'ball_speed': None, 'shot_name': None, 'ball_destination': 'Straight', 'out_type': 'Catch out , kohli'}  ... displaying 10 of 557 total bound parameter sets ...  {'match_id': '10082023', 'ball': 0.1, 'Commentary_Text': ' Starc to Rohit, no run, 136.1 clicks, big inswinger that thuds onto the pads. A half appeal from Starc but ending well down leg ', 'innings': '2nd Inns', 'batting_team': 'IND', 'bowling_team': 'AUS', 'Batsman': 'Rohit', 'Bowler': ' Starc', 'runs': '0', 'extra': '0', 'ball_length': None, 'ball_line': None, 'ball_speed': None, 'shot_name': None, 'ball_destination': None, 'out_type': None}, {'match_id': '10082023', 'ball': 0.1, 'Commentary_Text': " Starc to Rohit, wide, finds some swing but that movement takes the ball down the leg side. Sharma shimmies in and tries to flick but can't connect ", 'innings': '2nd Inns', 'batting_team': 'IND', 'bowling_team': 'AUS', 'Batsman': 'Rohit', 'Bowler': ' Starc', 'runs': 'wide', 'extra': '1', 'ball_length': None, 'ball_line': 'wide', 'ball_speed': None, 'shot_name': 'wide', 'ball_destination': None, 'out_type': None})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 47169)
[2023-12-09T19:18:39.913+0530] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-12-09T19:18:39.925+0530] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
